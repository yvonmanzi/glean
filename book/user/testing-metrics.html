<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Testing metrics - Glean - Cross-platform Telemetry library</title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
        <link rel="stylesheet" href="../tabs.css">
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li><a href="../index.html"><strong aria-hidden="true">1.</strong> Glean</a></li><li><a href="../user/index.html"><strong aria-hidden="true">2.</strong> Using the Glean SDK</a></li><li><ol class="section"><li><a href="../user/adding-glean-to-your-project.html"><strong aria-hidden="true">2.1.</strong> Adding Glean to your project</a></li><li><a href="../user/general-api.html"><strong aria-hidden="true">2.2.</strong> The General API</a></li><li><a href="../user/adding-new-metrics.html"><strong aria-hidden="true">2.3.</strong> Adding new metrics</a></li><li><a href="../user/metric-parameters.html"><strong aria-hidden="true">2.4.</strong> Metric parameters</a></li><li><a href="../user/testing-metrics.html" class="active"><strong aria-hidden="true">2.5.</strong> Testing metrics</a></li><li><a href="../user/debugging/index.html"><strong aria-hidden="true">2.6.</strong> Debugging products using Glean</a></li><li><ol class="section"><li><a href="../user/debugging/android.html"><strong aria-hidden="true">2.6.1.</strong> Android</a></li><li><a href="../user/debugging/ios.html"><strong aria-hidden="true">2.6.2.</strong> iOS</a></li></ol></li><li><a href="../user/error-reporting.html"><strong aria-hidden="true">2.7.</strong> Error reporting</a></li><li><a href="../user/experiments-api.html"><strong aria-hidden="true">2.8.</strong> Using the experiments API</a></li><li><a href="../user/metrics/index.html"><strong aria-hidden="true">2.9.</strong> Metric types</a></li><li><ol class="section"><li><a href="../user/metrics/boolean.html"><strong aria-hidden="true">2.9.1.</strong> Boolean</a></li><li><a href="../user/metrics/counter.html"><strong aria-hidden="true">2.9.2.</strong> Counter</a></li><li><a href="../user/metrics/labeled_counters.html"><strong aria-hidden="true">2.9.3.</strong> Labeled Counters</a></li><li><a href="../user/metrics/string.html"><strong aria-hidden="true">2.9.4.</strong> String</a></li><li><a href="../user/metrics/labeled_strings.html"><strong aria-hidden="true">2.9.5.</strong> Labeled Strings</a></li><li><a href="../user/metrics/string_list.html"><strong aria-hidden="true">2.9.6.</strong> String List</a></li><li><a href="../user/metrics/timespan.html"><strong aria-hidden="true">2.9.7.</strong> Timespan</a></li><li><a href="../user/metrics/timing_distribution.html"><strong aria-hidden="true">2.9.8.</strong> Timing Distribution</a></li><li><a href="../user/metrics/memory_distribution.html"><strong aria-hidden="true">2.9.9.</strong> Memory Distribution</a></li><li><a href="../user/metrics/uuid.html"><strong aria-hidden="true">2.9.10.</strong> UUID</a></li><li><a href="../user/metrics/datetime.html"><strong aria-hidden="true">2.9.11.</strong> Datetime</a></li><li><a href="../user/metrics/event.html"><strong aria-hidden="true">2.9.12.</strong> Event</a></li><li><a href="../user/metrics/custom_distribution.html"><strong aria-hidden="true">2.9.13.</strong> Custom Distribution</a></li><li><a href="../user/metrics/quantity.html"><strong aria-hidden="true">2.9.14.</strong> Quantity</a></li></ol></li><li><a href="../user/pings/index.html"><strong aria-hidden="true">2.10.</strong> Pings</a></li><li><ol class="section"><li><a href="../user/pings/baseline.html"><strong aria-hidden="true">2.10.1.</strong> Baseline Ping</a></li><li><a href="../user/pings/deletion_request.html"><strong aria-hidden="true">2.10.2.</strong> Deletion Request Ping</a></li><li><a href="../user/pings/metrics.html"><strong aria-hidden="true">2.10.3.</strong> Metrics Ping</a></li><li><a href="../user/pings/events.html"><strong aria-hidden="true">2.10.4.</strong> Events Ping</a></li><li><a href="../user/pings/custom.html"><strong aria-hidden="true">2.10.5.</strong> Custom Pings</a></li><li><a href="../user/pings/testing-custom-pings.html"><strong aria-hidden="true">2.10.6.</strong> Testing custom pings</a></li></ol></li><li><a href="../user/android-build-configuration-options.html"><strong aria-hidden="true">2.11.</strong> Android build configuration options</a></li><li><a href="../user/focused-use-cases.html"><strong aria-hidden="true">2.12.</strong> Focused Use Cases</a></li><li><ol class="section"><li><a href="../user/instrument-android-crashes-example.html"><strong aria-hidden="true">2.12.1.</strong> Instrumenting Android Crashes With Glean</a></li></ol></li></ol></li><li><a href="../user/collected-metrics/metrics.html"><strong aria-hidden="true">3.</strong> Metrics collected by the Glean SDK</a></li><li><a href="../dev/index.html"><strong aria-hidden="true">4.</strong> Developing the Glean SDK</a></li><li><ol class="section"><li><a href="../dev/testing.html"><strong aria-hidden="true">4.1.</strong> Testing</a></li><li><a href="../dev/docs.html"><strong aria-hidden="true">4.2.</strong> Developing documentation</a></li><li><a href="../dev/android/index.html"><strong aria-hidden="true">4.3.</strong> Android bindings</a></li><li><ol class="section"><li><a href="../dev/android/setup-android-build-environment.html"><strong aria-hidden="true">4.3.1.</strong> Setup Build Environment</a></li></ol></li><li><a href="../dev/ios/index.html"><strong aria-hidden="true">4.4.</strong> iOS bindings</a></li><li><ol class="section"><li><a href="../dev/ios/setup-ios-build-environment.html"><strong aria-hidden="true">4.4.1.</strong> Setup Build Environment</a></li><li><a href="../dev/ios/debug-glean-on-ios.html"><strong aria-hidden="true">4.4.2.</strong> Debugging Different Versions of Glean</a></li></ol></li><li><a href="../dev/python/index.html"><strong aria-hidden="true">4.5.</strong> Python bindings</a></li><li><ol class="section"><li><a href="../dev/python/setting-up-python-build-environment.html"><strong aria-hidden="true">4.5.1.</strong> Setup Build Environment</a></li></ol></li><li><a href="../dev/core/index.html"><strong aria-hidden="true">4.6.</strong> Rust Component</a></li><li><ol class="section"><li><a href="../dev/core/dependency-management.html"><strong aria-hidden="true">4.6.1.</strong> Dependency Management</a></li><li><a href="../dev/core/new-metric-type.html"><strong aria-hidden="true">4.6.2.</strong> Adding a new metric type</a></li><li><ol class="section"><li><a href="../dev/core/new-metric-type/ffi.html"><strong aria-hidden="true">4.6.2.1.</strong> FFI</a></li><li><a href="../dev/core/new-metric-type/kotlin.html"><strong aria-hidden="true">4.6.2.2.</strong> Kotlin</a></li><li><a href="../dev/core/new-metric-type/swift.html"><strong aria-hidden="true">4.6.2.3.</strong> Swift</a></li></ol></li></ol></li><li><a href="../dev/ffi/index.html"><strong aria-hidden="true">4.7.</strong> FFI Layer</a></li><li><ol class="section"><li><a href="../dev/ffi/when-to-use-what-in-the-ffi.html"><strong aria-hidden="true">4.7.1.</strong> When/How FFI</a></li></ol></li><li><a href="../dev/cut-a-new-release.html"><strong aria-hidden="true">4.8.</strong> Release process</a></li><li><a href="../contributing.html"><strong aria-hidden="true">4.9.</strong> Contributing</a></li><li><ol class="section"><li><a href="../code_coverage.html"><strong aria-hidden="true">4.9.1.</strong> Code coverage</a></li></ol></li><li><a href="../dev/core/internal/index.html"><strong aria-hidden="true">4.10.</strong> Internal implementation details</a></li><li><ol class="section"><li><a href="../dev/core/internal/reserved-ping-names.html"><strong aria-hidden="true">4.10.1.</strong> Reserved ping names</a></li><li><a href="../dev/core/internal/clearing.html"><strong aria-hidden="true">4.10.2.</strong> Clearing metrics when disabling/enabling Glean</a></li><li><a href="../dev/core/internal/payload.html"><strong aria-hidden="true">4.10.3.</strong> Payload format</a></li><li><a href="../dev/core/internal/directory-structure.html"><strong aria-hidden="true">4.10.4.</strong> Directory structure</a></li><li><a href="../dev/core/internal/debug-pings.html"><strong aria-hidden="true">4.10.5.</strong> Debug Pings</a></li></ol></li><li><a href="../dev/howtos/index.html"><strong aria-hidden="true">4.11.</strong> Howtos</a></li><li><ol class="section"><li><a href="../dev/howtos/development-with-android-components.html"><strong aria-hidden="true">4.11.1.</strong> Development with android-components</a></li><li><a href="../dev/howtos/locally-published-components-in-fenix.html"><strong aria-hidden="true">4.11.2.</strong> Locally-published components in Fenix</a></li></ol></li></ol></li><li><a href="../api/index.html"><strong aria-hidden="true">5.</strong> API Documentation</a></li><li><a href="../appendix/index.html"><strong aria-hidden="true">6.</strong> Appendix</a></li><li><ol class="section"><li><a href="../appendix/changelog.html"><strong aria-hidden="true">6.1.</strong> Changelog</a></li><li><a href="../appendix/twig.html"><strong aria-hidden="true">6.2.</strong> This Week in Glean</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">Glean - Cross-platform Telemetry library</h1>

                        <div class="right-buttons">
                            <a href="../print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#unit-testing-glean-metrics" id="unit-testing-glean-metrics">Unit testing Glean metrics</a></h1>
<p>In order to support unit testing inside of client applications using the Glean SDK, a set of testing API functions have been included.
The intent is to make the Glean SDK easier to test 'out of the box' in any client application it may be used in.
These functions expose a way to inspect and validate recorded metric values within the client application but are restricted to test code only through visibility annotations
(<code>@VisibleForTesting(otherwise = VisibleForTesting.NONE)</code> for Kotlin, <code>internal</code> methods for Swift).</p>
<h2><a class="header" href="#general-test-api-method-semantics" id="general-test-api-method-semantics">General test API method semantics</a></h2>
<div class="tabs">
<div class="tabbar"></div>
<div class="tabcontents">
<div data-lang="Kotlin" class="tab">
<p>In order to prevent issues with async calls when unit testing Glean,
it is important to put the Glean SDK into testing mode by applying the JUnit <code>GleanTestRule</code> to your test class.
When the Glean SDK is in testing mode, it enables uploading and clears the recorded metrics at the beginning of each test run.
The rule can be used as shown below:</p>
<pre><code class="language-kotlin">@RunWith(AndroidJUnit4::class)
class ActivityCollectingDataTest {
    // Apply the GleanTestRule to set up a disposable Glean instance.
    // Please note that this clears the Glean data across tests.
    @get:Rule
    val gleanRule = GleanTestRule(ApplicationProvider.getApplicationContext())

    @Test
    fun checkCollectedData() {
      // The Glean SDK testing API can be called here.
    }
}
</code></pre>
<p>This will ensure that metrics are done recording when the other test functions are used.</p>
<p>To check if a value exists (i.e. it has been recorded), there is a <code>testHasValue()</code> function on each of the metric instances:</p>
<pre><code class="language-kotlin">assertTrue(GleanMetrics.Search.defaultSearchEngineUrl.testHasValue())
</code></pre>
<p>To check the actual values, there is a <code>testGetValue()</code> function on each of the metric instances.
It is important to check that the values are recorded as expected, since many of the metric types may truncate or error-correct the value.
This function will return a datatype appropriate to the specific type of the metric it is being used with:</p>
<pre><code class="language-kotlin">assertEquals(&quot;https://example.com/search?&quot;, GleanMetrics.Search.defaultSearchEngineUrl.testGetValue())
</code></pre>
<p>Note that each of these functions has its visibility limited to the scope of unit tests by making use of the <code>@VisibleForTesting</code> annotation,
so the IDE should complain if you attempt to use them inside of client code.</p>
</div>
<div data-lang="Swift" class="tab">
<blockquote>
<p><strong>NOTE</strong>: There's no automatic test rule for Glean tests implemented.</p>
</blockquote>
<p>In order to prevent issues with async calls when unit testing Glean, it is important to put the Glean SDK into testing mode.
When the Glean SDK is in testing mode, it enables uploading and clears the recorded metrics at the beginning of each test run.</p>
<p>Activate it by resetting Glean in your test's setup:</p>
<pre><code class="language-swift">@testable import Glean
import XCTest

class GleanUsageTests: XCTestCase {
    override func setUp() {
        Glean.shared.resetGlean(clearStores: true)
    }

    // ...
}
</code></pre>
<p>This will ensure that metrics are done recording when the other test functions are used.</p>
<p>To check if a value exists (i.e. it has been recorded), there is a <code>testHasValue()</code> function on each of the metric instances:</p>
<pre><code class="language-Swift">XCTAssertTrue(GleanMetrics.Search.defaultSearchEngineUrl.testHasValue())
</code></pre>
<p>To check the actual values, there is a <code>testGetValue()</code> function on each of the metric instances.
It is important to check that the values are recorded as expected, since many of the metric types may truncate or error-correct the value.
This function will return a datatype appropriate to the specific type of the metric it is being used with:</p>
<pre><code class="language-Swift">XCTAssertEqual(&quot;https://example.com/search?&quot;, try GleanMetrics.Search.defaultSearchEngineUrl.testGetValue())
</code></pre>
<p>Note that each of these functions is marked as <code>internal</code>, you need to import <code>Glean</code> explicitly in test mode:</p>
<pre><code class="language-Swift">@testable import Glean
</code></pre>
</div>
<div data-lang="Python" class="tab">
<p>It is generally a good practice to &quot;reset&quot; Glean prior to every unit test that uses Glean, to prevent side effects of one unit test impacting others.
Glean contains a helper function <code>glean.testing.reset_glean()</code> for this purpose.
It has two required arguments: the application ID, and the application version.
Each reset of Glean will create a new temporary directory for Glean to store its data in.
This temporary directory is automatically cleaned up the next time Glean is reset or when the testing framework finishes.</p>
<p>The instructions below assume you are using <a href="https://pypi.org/project/pytest/">pytest</a> as the test runner.
Other test-running libraries have similar features, but are different in the details.</p>
<p>Create a file <code>conftest.py</code> at the root of your test directory, and add the following to reset Glean at the start of every test in your suite:</p>
<pre><code class="language-python">import pytest
from glean import testing

@pytest.fixture(name=&quot;reset_glean&quot;, scope=&quot;function&quot;, autouse=True)
def fixture_reset_glean():
    testing.reset_glean(&quot;my-app-id&quot;, &quot;0.1.0&quot;)
</code></pre>
<p>To check if a value exists (i.e. it has been recorded), there is a <code>test_has_value()</code> function on each of the metric instances:</p>
<pre><code class="language-python">from glean import load_metrics
metrics = load_metrics(&quot;metrics.yaml&quot;)

# ...

assert metrics.search.search_engine_url.test_has_value()
</code></pre>
<p>To check the actual values, there is a <code>test_get_value()</code> function on each of the metric instances.
It is important to check that the values are recorded as expected, since many of the metric types may truncate or error-correct the value.
This function will return a datatype appropriate to the specific type of the metric it is being used with:</p>
<pre><code class="language-python">assert (
    &quot;https://example.com/search?&quot; ==
    metrics.search.default_search_engine_url.test_get_value()
)
</code></pre>
</div>
</div>
</div>
<h2><a class="header" href="#testing-metrics-for-custom-pings" id="testing-metrics-for-custom-pings">Testing metrics for custom pings</a></h2>
<p>In order to test metrics where the metric is included in more than one ping, the test functions take an optional <code>pingName</code> argument (<code>ping_name</code> in Python).
This is the name of the ping that the metric is being sent in, such as <code>&quot;events&quot;</code> for the <a href="pings/events.html"><code>events</code> ping</a>,
or <code>&quot;metrics&quot;</code> for the <a href="pings/metrics.html"><code>metrics</code> ping</a>.
This could also be a custom ping name that the metric is being sent in.
In most cases you should not have to supply the ping name to the test function and can just use the default which is the &quot;default&quot; ping that this metric is sent in.
You should only need to provide a <code>pingName</code> if the metric is being sent in more than one ping in order to identify the correct metric store.</p>
<p>You can call the <code>testHasValue()</code> and <code>testGetValue()</code> functions with <code>pingName</code> like this:</p>
<pre><code class="language-kotlin">GleanMetrics.Foo.uriCount.testHasValue(&quot;customPing&quot;)
GleanMetrics.Foo.uriCount.testGetValue(&quot;customPing&quot;)
</code></pre>
<h2><a class="header" href="#example-of-using-the-test-api" id="example-of-using-the-test-api">Example of using the test API</a></h2>
<div class="tabs">
<div class="tabbar"></div>
<div class="tabcontents">
<div data-lang="Kotlin" class="tab">
<p>Here is a longer example to better illustrate the intended use of the test API:</p>
<pre><code class="language-kotlin">// Record a metric value with extra to validate against
GleanMetrics.BrowserEngagement.click.record(
    mapOf(
        BrowserEngagement.clickKeys.font to &quot;Courier&quot;
    )
)

// Record more events without extras attached
BrowserEngagement.click.record()
BrowserEngagement.click.record()

// Check if we collected any events into the 'click' metric
assertTrue(BrowserEngagement.click.testHasValue())

// Retrieve a snapshot of the recorded events
val events = BrowserEngagement.click.testGetValue()

// Check if we collected all 3 events in the snapshot
assertEquals(3, events.size)

// Check extra key/value for first event in the list
assertEquals(&quot;Courier&quot;, events.elementAt(0).extra[&quot;font&quot;])
</code></pre>
</div>
<div data-lang="Swift" class="tab">
<p>Here is a longer example to better illustrate the intended use of the test API:</p>
<pre><code class="language-Swift">// Record a metric value with extra to validate against
GleanMetrics.BrowserEngagement.click.record([.font: &quot;Courier&quot;])

// Record more events without extras attached
BrowserEngagement.click.record()
BrowserEngagement.click.record()

// Check if we collected any events into the 'click' metric
XCTAssertTrue(BrowserEngagement.click.testHasValue())

// Retrieve a snapshot of the recorded events
let events = try! BrowserEngagement.click.testGetValue()

// Check if we collected all 3 events in the snapshot
XCTAssertEqual(3, events.count)

// Check extra key/value for first event in the list
XCTAssertEqual(&quot;Courier&quot;, events[0].extra?[&quot;font&quot;])
</code></pre>
</div>
<div data-lang="Python" class="tab">
<p>Here is a longer example to better illustrate the intended use of the test API:</p>
<pre><code class="language-python">from glean import load_metrics
metrics = load_metrics(&quot;metrics.yaml&quot;)

# Record a metric value with extra to validate against
metrics.url.visit.add(1)

# Check if we collected any events into the 'click' metric
assert metrics.url.visit.test_has_value()

# Retrieve a snapshot of the recorded events
assert 1 == metrics.url.visit.test_get_value()
</code></pre>
</div>
</div>
</div>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../user/metric-parameters.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../user/debugging/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="../user/metric-parameters.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="../user/debugging/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        <script type="text/javascript" src="../tabs.js"></script>
        

        

    </body>
</html>
